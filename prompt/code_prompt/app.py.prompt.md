# app.py Prompt

你是资深 Python 桌面应用工程师。请基于 `prompt/needs.txt` 生成 **`app.py`** 的实现代码。只输出该文件的代码，不要输出其他文件，不要输出解释性文字。

## 目标与职责
- 作为程序入口与主窗口控制器。
- 管理主窗口布局：左侧截图预览、右侧结果文本、下方/右侧日志与进度区。
- 管理 Tabs：Tab1=OCR 原始结果，Tab2=表格预处理。
- 负责按钮交互：截图、Copy、Clear。
- 负责模式选择：表格/文本（含自动检测与手动覆盖）。
- 协调 `capture.py`、`ocr_engine.py`、`layout.py`、`postprocess.py` 的调用。

## 约束
- 仅 CPU；Python 3.11；Windows 11。
- 不实现 OCR 训练、复杂图像编辑、PDF 多页导入。
- 代码注释必须为英文。
- 与其余模块的接口需清晰、最小化耦合。

## 需要暴露/调用的接口（请在代码中清晰定义）
- 从 `capture.py`：截图库与全局快捷键注册、截图结果回调。
- 从 `ocr_engine.py`：OCR 识别入口、初始化耗时可控。
- 从 `layout.py`：表格/文本布局重建（TSV/文本输出）。
- 从 `postprocess.py`：表格预处理管线、配置读写、复制策略。

## UI 行为要点
- 点击“截图”进入框选；确认后触发 OCR。
- 结果显示在右侧；Tab2 的输入来自 Tab1 的表格 TSV。
- Copy：复制当前 Tab 的输出到剪贴板。
- Clear：清空预览、结果、预处理输出与日志（或至少核心区）。
- 日志与进度：显示 8 个阶段并记录开始/结束与耗时。

## 自动模式检测
- 表格模式触发条件：
  - x 坐标聚类列数 ≥ 2，或
  - token 中“数字+工程前缀”占比高。
- 允许用户手动切换覆盖自动检测。

## 输出要求
- 保证可运行结构与主入口（例如 `if __name__ == "__main__":`）。
- GUI 框架可选，但要适配 Windows 11（常用 Tkinter/PySide6/Qt 均可）。
- 仅输出 `app.py` 代码。